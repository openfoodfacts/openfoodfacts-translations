××™×š × ×¢×©×” ×©×™××•×© ×‘×œ×•×’×•××™× ×‘Ö¾Open Food Facts ×›×“×™ ×œ×§×‘×œ ××™×“×¢ ×¢×œ ××•×¦×¨×™ ××–×•×Ÿ

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>ğŸ§‚ ××¢×˜ ×”×§×©×¨:</strong> â€×œ×•×’×•××™×â€?</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>×‘Ö¾Open Food Facts ×§×™×™××™× ×›×¨×’×¢ ×‘×¢×¨×š <strong>3 ××™×œ×™×•×Ÿ ××•×¦×¨×™×</strong>. ×œ×›×œ ××•×¦×¨ ×™×© ××¨×™×–×” ×©× ×•×¢×“×” ×œ××©×•×š ×›××” ×©×™×•×ª×¨ ×× ×©×™×. To this regard, productors highlight the qualities of their products with<strong> flashy and explicit symbols</strong>. These symbols are numerous and can give information on the brand of the product, its quality, its composition, the way it was made, in which bean to discard it, etcâ€¦&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>To homogenize all symbols and help consumers to find products that fit them, <strong>various institutions have created strict rules for producers to be able to mark their products with specific symbols which we call â€œlogosâ€</strong>. ×œ×›×Ÿ ×–××ª ×”×–×“×× ×•×ª ××“×™×¨×” ğŸ”¥ ×œ×§×‘×œ ××™×“×¢ ×¢×œ ××•×¦×¨×™× ×¢×œ ×™×“×™ ×–×™×”×•×™ ×”×œ×•×’×•××™× ×”××œ×”!</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>××™×š ×××•×¨ Open Food Facts ×œ×–×”×•×ª ××•×ª×? ×ª×•×“×•×ª ×œ×¢×¨×‘×•×‘ ×‘×™×Ÿ ×˜×›× ×•×œ×•×’×™×” ×•××ª× ×“×‘×™×, ×›××• ×ª××™×“!</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>RaphaÃ«l Bournhonesque, a former Open Food Facts contributor who is now part of the permanent team and my internship supervisor, had developed in Robotoff* <strong>a system to extract logos from images, convert them into vectors and find the nearest neighbours of each vector.</strong> The goal of finding logosâ€™ neighbours was <strong>to allow contributors to â€œannotateâ€ (to categorise manually) massive amounts of logos at the same time through a platform, named <a rel="noreferrer noopener" href="https://hunger.openfoodfacts.org/" target="_blank">Hunger Games</a> </strong>ğŸ˜‰.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, the models and algorithms used back then could not give efficient enough results.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>×‘×¡×¤×˜××‘×¨ 2022, ×× ×™, ×¡×˜×•×“× ×˜ ×œ×”× ×“×¡×”, ×”×¦×˜×¨×¤×ª×™ ×œ×¦×•×•×ª ×œ×”×ª××—×•×ª ×©×œ 6 ×—×•×“×©×™× ×©××•×§×“×©×ª ×œ×œ×•×’×•××™×, ×•×¢×‘×“×ª×™ ×¢×œ ×—×™×“×•×© ×›×œ ×”×ª×”×œ×™×š ×”×–×”! ğŸ¥³&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:table -->
<figure class="wp-block-table"><table><tbody><tr><td><strong>* ××” ×–×” Robotoff ?</strong><br><a rel="noreferrer noopener" href="https://github.com/openfoodfacts/robotoff" target="_blank">Robotoff</a> ×”×•× ×©×™×¨×•×ª ×©×¤×•×ª×— ×¢×œ ×™×“×™ ××ª× ×“×‘×™× ×›×“×™ ×œ×¡×™×™×¢ ×‘×¢×™×‘×•×“ × ×ª×•× ×™× ×‘Ö¾Open Food Facts. Based on the data already available in the database, the goal is to retrieve as much information as possible on each product and to add them to the db. Currently, the updates made by Robotoff come from images analysis, through Optical Character Recognition or more general Computer Vision models. Some updates are applied automatically to the db but some others need manual validation via questions or Hunger Games.<br><br><em><strong>To know more about Robotoff, take a look <a rel="noreferrer noopener" href="https://github.com/openfoodfacts/robotoff#readme" target="_blank">here</a>!</strong></em> ğŸ‘€</td></tr></tbody></table></figure>
<!-- /wp:table -->

<!-- wp:heading {"level":3} -->
<h3><strong>ğŸ«— ×˜×™×¤×•× ×ª ×˜×›× ×•×œ×•×’×™×”: </strong>××™×š ×‘×“×™×•×§ ×¢×•×‘×“ ×¢×™×‘×•×“ ×œ×•×’×•××™×?</h3>
<!-- /wp:heading -->

<!-- wp:heading {"level":4} -->
<h4><em>1ï¸âƒ£ </em>×—×™×œ×•×¥ ×œ×•×’×•××™× ××ª××•× ×•×ª ××•×¦×¨×™×:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>××ª× ×“×‘×™ Open Food Facts ××™×× ×• ××•×“×œ ×œ××™×“×ª ××›×•× ×” ×›×“×™ ×©×™×–×”×” ×œ×•×’×•××™× ×‘×ª××•× ×•×ª. ×× ×• ××¡×¤×§×™× ×ª××•× ×” ×›×§×œ×˜ ×œ××•×“×œ ×•××§×‘×œ×™× ××¡×¤×¨ ×ª×™×‘×•×ª ×ª×•×—××•×ª ×¢× ×“×™×¨×•×’×™× ×•×¡×™×•×•×’×™× ×‘×”×ª×××”. ×”×¡×™×•×•×’×™× ×©×¢×œ×™×”×Ÿ ××•××Ÿ ×”××•×“×œ ×”×Ÿ â€××•×ª×’â€œ ×•â€×ª×•×•×™×ªâ€.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>×›××Ÿ ××¤×©×¨ ×œ××¦×•× ××ª ×”×§×•×“ ×©×§×•×¨× ×œ××•×“×œ: <a href="https://github.com/openfoodfacts/robotoff/blob/b209707cc062310b51f9886c87ee14be91527644/robotoff/workers/tasks/import_image.py#L325" target="_blank" rel="noreferrer noopener">Robotoff.import_image.py</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>××¤×©×¨ ×œ×”×ª× ×¡×•×ª ×‘×• ×“×¨×š ×”Ö¾API ×”×‘×:&nbsp;<a href="https://robotoff.openfoodfacts.net/api/v1/images/predict?image_url=[image_url]&amp;models=universal-logo-detector" target="_blank" rel="noreferrer noopener">https://robotoff.openfoodfacts.net/api/v1/images/predict?image_url=[image_url]&amp;models=universal-logo-detector</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>With the bounding boxes, you can see what are the corresponding logos with the API: <a href="https://robotoff.openfoodfacts.net/api/v1/images/crop?image_url=[image_url]&amp;y_min=[y_min]&amp;x_min=[x_min]&amp;y_max=[y_max]&amp;x_max=[x_max]" target="_blank" rel="noreferrer noopener">https://robotoff.openfoodfacts.net/api/v1/images/crop?image_url=[image_url]&amp;y_min=[y_min]&amp;x_min=[x_min]&amp;y_max=[y_max]&amp;x_max=[x_max]</a> where the coordinates are in the same order as the ones returned by the model in the bounding boxes.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>×”× ×” ×“×•×’××” ×œ××” ×©×§×•×¨×” ×‘×¢×ª ×©×™××•×© ×‘×× ×©×§×™ ×”Ö¾API ×”××œ×” ×¢× ×”×ª××•× ×” ×”×‘××”:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://images.openfoodfacts.org/images/products/322/982/012/9488/front_fr.194.400.jpg" target="_blank" rel="noreferrer noopener">https://images.openfoodfacts.org/images/products/322/982/012/9488/front_fr.194.400.jpg</a></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3425,"width":806,"height":252,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large is-resized"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Screenshot-2023-02-14-at-14.34.51-1024x321.png" alt="" class="wp-image-3425" width="806" height="252"/></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4><em>2ï¸âƒ£ </em>×”××¨×ª ×ª××•× ×•×ª ×œ×•×’×•××™× ×œ×•×•×§×˜×•×¨×™×:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>×¢×›×©×™×• ×›×©×™×© ×œ× ×• ×’×™×©×” ×œ×œ×•×’×•××™×, ×× ×—× ×• ×¦×¨×™×›×™× ×œ×”××™×¨ ××•×ª× ×œ×™×™×¦×•×’ ×•×§×˜×•×¨×™</strong>. ×œ×©× ×›×š, × ×©×ª××© ×‘××•×“×œ ×©×œ OpenAI ×©××•××Ÿ ××¨××© ×‘×©× <a href="https://huggingface.co/docs/transformers/model_doc/clip" target="_blank" rel="noreferrer noopener">CLIP</a>. ×œ××¨×•×ª ×©×”××•×“×œ ×œ× ××•××Ÿ ×œ×ª×¤×•×¡ ×ª××•× ×•×ª ×¢× ×˜×§×¡×˜, ×× ×—× ×• ××©×ª××©×™× ×‘×—×œ×§ â€×¨××™×™×ª ×”××›×•× ×”â€ ×©×œ ×”××•×“×œ ×›×“×™ ×œ×§×‘×œ ×”×˜××¢×•×ª (=×œ×•×’×•××™× ××•×˜××¢×™× ×‘××¨×—×‘ ×•×§×˜×•×¨×™) ×©××—×•×©×‘×•×ª ×¢×œ ×™×“×™ CLIP ×œ×›×œ ×œ×•×’×• ×•×œ×•×’×•.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>×œ×›×Ÿ ×™×© ×œ× ×• ×ª××•× ×ª ×œ×•×’×• ×›×§×œ×˜ ×•×××“×™ ×•×§×˜×•×¨ ×©×œ 512 ×›×¤×œ×˜. ×›×›×œ ×©×”××¨×—×§ ×‘×™×Ÿ ×©× ×™ ×”×•×•×§×˜×•×¨×™× ×§×˜×Ÿ ×™×•×ª×¨, ×›×š ×©× ×™ ×”×œ×•×’×•××™× ×”×ª×•×××™× ×“×•××™× ×™×•×ª×¨.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>×”×¤×•× ×§×¦×™×” <a href="https://github.com/openfoodfacts/robotoff/blob/b209707cc062310b51f9886c87ee14be91527644/robotoff/workers/tasks/import_image.py#L398" target="_blank" rel="noreferrer noopener">save_logo_embeddings</a> ×‘Ö¾Robotoff ××—×¨××™×ª ×¢×œ ×”×—×œ×ª ×”××•×“×œ ×¢×œ ×œ×•×’×•××™× ×•×¢×œ ×©××™×¨×ª ×”××™××•×©×™× ×œ××¡×“ ×”× ×ª×•× ×™× ×©×œ Robotoff ××¡×•×’ postgresql.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>You can find a more explicit code <a href="https://github.com/openfoodfacts/openfoodfacts-ai/blob/develop/logo-ann/generation/02_generate_embeddings.py#L108" target="_blank" rel="noreferrer noopener">here</a> to understand how we use CLIP to generate logos embeddings.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4><em>3ï¸âƒ£ </em>××™×ª×•×¨ ×”×©×›× ×™× ×”×§×¨×•×‘×™× ×‘×™×•×ª×¨:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>×›×“×™ ×œ××¦×•× ××ª ×”×©×›× ×™× ×”×§×¨×•×‘×™× ×‘×™×•×ª×¨ ×©×œ ×œ×•×’×•, ×× ×™ ××©×ª××©×™× ×‘â€××¤×ª×—â€ ×›×“×™ ×œ××—×¡×Ÿ ××ª ×”×”×˜××¢×•×ª. Once this index is built, we could use the <strong>â€œbrute forceâ€ ğŸ’ª method which consists in computing the distance between the query logo and all the other logos of the db and return the closest ones</strong>. Thatâ€™s the most precise method as it gives us the â€œtrueâ€ nearest neighbors. ×¢× ×–××ª, ×”×©×™×˜×” ×”×–××ª ××™×˜×™×ª ××›×“×™ ×œ×™×™×©× ××•×ª×”. The time needed to extract the nearest neighbors for each logo when the total amount of logos is 2.5M is around 3s ğŸ˜´</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>As we needed a better search time and were ok with having less precision, we decided to use <strong>an approximate method</strong>. ×–×” ×©Ö¾Robotoff ××©×ª××© ×‘×• × ×§×¨× HNSWâ€ (hierarchical navigable small world - ×¢×•×œ× ×§×˜×Ÿ ×”×™×¨×¨×›×™ ×©××¤×©×¨ ×œ× ×•×•×˜ ×‘×•). ××¤×©×¨ ×œ×¤× ×•×ª ×œ<a rel="noreferrer noopener" href="https://www.pinecone.io/learn/vector-indexes/" target="_blank">××××¨ ×”×–×”</a> ×›×“×™ ×œ×”×‘×™×Ÿ ×˜×•×‘ ×™×•×ª×¨ ××™×š ×¢×•×‘×“ ×—×™×¤×•×© ×”×©×›× ×™× ×”×§×¨×•×‘×™× ×‘×™×•×ª×¨.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Using a HNSW ElasticSearch index, Robotoff is now able to look for the nearest neighbours of each embedding among more than 2.5M vectors with a huge precision (more than 90% of the 100 nearest neighbours returned are among the exact 100 true nearest neighbours) and a short search time of less than 100ms ğŸ‘ğŸ‘ğŸ‘ğŸ‘.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>××¤×©×¨ ×œ×”×©×ª××© ×‘Ö¾API ×”×‘× ×›×“×™ ×œ×§×‘×œ ××ª ×”×©×›× ×™× ×”×§×¨×•×‘×™× ×‘×™×•×ª×¨ ×©×œ ×œ×•×’×•: <a href="https://robotoff.openfoodfacts.org/api/v1/ann/search/[logo_id]?count=[count]">https://robotoff.openfoodfacts.org/api/v1/ann/search/[logo_id]?count=[count]</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>ğŸ¯ ×›×¤×™×ª ×©×œ ×ª×¨×•××•×ª: </strong>××™×¤×” ××©×ª××©×™× ×‘×”?</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>×œ× ×”×•×˜××¢ ×¢×“×™×™×Ÿ ×¡×™×•×•×’ ×œ×•×’×•××™× ××•×˜×•××˜×™ ×‘Ö¾Robotoff. ×›×œ ××” ×©×”×¡×‘×¨×ª×™ ×§×•×“× ×œ×›×Ÿ × ×•×¦×¨ ×¨×§ ×¢×‘×•×¨ <a href="https://hunger.openfoodfacts.org/">××©×—×§×™ ×”×¢×¨×‘</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>××” ×–×”? It is <strong>an annotation platform </strong>developed by a contributor named Alexandre Fauquette which <strong>allows everyone to answer check predictions made by Robotoff and to categorise logos</strong>.&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><br>××¤×©×¨ ×œ×”×ª× ×¡×•×ª ×‘×–×”. ×”×™×›×¨×•×ª/×”×“×¨×›×” ×–×¨×™×–×” ×ª×§×‘×œ ××ª ×¤× ×™×š ×•××¤×©×¨ ×™×”×™×” ×œ×”×ª×—×™×œ ×œ×¤×¨×© ×œ×•×’×•××™×! ğŸ˜‰<br>×¡×¨×˜×•×Ÿ ×”×“×¨×›×” ×¢×œ â€×›×™×¦×“ ×œ×”×©×ª××© ×‘××©×—×§×™ ×”×¨×¢×‘?â€ ×××•×¨ ×œ×¦××ª ×‘×§×¨×•×‘â€¦ â³</p>
<!-- /wp:paragraph -->

<!-- wp:image {"align":"center","id":3433,"width":505,"height":633,"sizeSlug":"full","linkDestination":"custom"} -->
<figure class="wp-block-image aligncenter size-full is-resized"><a href="hunger.openfoodfacts.org"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Screenshot-2023-02-14-at-14.44.23.png" alt="" class="wp-image-3433" width="505" height="633"/></a><figcaption class="wp-element-caption">×›×“×™ ×œ×©×—×§ ×‘××©×—×§×™ ×”×¨×¢×‘: hunger.openfoodfacts.org</figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><strong>Annotating logos enhance Open Food Facts as it grows the amount of data we have on products and its quality.</strong> And thanks to the models and algorithms used in the background, you can be way more powerful and have a greater impact on people daily alimentation ğŸ¥°.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>×›×ª×‘×” ×××ª ×’×‘×¨×™××œ</p>
<!-- /wp:paragraph -->

<!-- wp:image {"align":"left","id":3418,"width":167,"height":167,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image alignleft size-full is-resized"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Gabriel.png" alt="" class="wp-image-3418" width="167" height="167"/></figure>
<!-- /wp:image -->
