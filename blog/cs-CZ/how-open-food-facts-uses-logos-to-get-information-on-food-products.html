Jak Open Food Facts pouÅ¾Ã­vÃ¡ loga k zÃ­skÃ¡nÃ­ informacÃ­ o potravinÃ¡Å™skÃ½ch produktech

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>ğŸ§‚Å petka kontextu:</strong> â€logaâ€œ ?</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Open Food Facts je naplnÄ›no asi <strong>tÅ™emi miliony produktÅ¯</strong>. KaÅ¾dÃ½ produkt mÃ¡ obal, kterÃ½ je vyroben tak, aby zaujal co nejvÃ­ce lidÃ­. V tomto ohledu vÃ½robci zdÅ¯razÅˆujÃ­ kvality svÃ½ch vÃ½robkÅ¯<strong> okÃ¡zalÃ½mi a explicitnÃ­mi symboly</strong>. TÄ›chto symbolÅ¯ je mnoho a mohou poskytnout informace o znaÄce produktu, jeho kvalitÄ›, sloÅ¾enÃ­, zpÅ¯sobu vÃ½roby, jakÃ½m zpÅ¯sobem jej zlikvidovat atdâ€¦&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>S cÃ­lem homogenizovat vÅ¡echny symboly a pomoci spotÅ™ebitelÅ¯m najÃ­t produkty, kterÃ© jim vyhovujÃ­, vytvoÅ™ily <strong>instituce pÅ™Ã­snÃ¡ pravidla pro vÃ½robce, aby mohli svÃ© produkty oznaÄovat specifickÃ½mi symboly, kterÃ½m Å™Ã­kÃ¡me â€logaâ€œ</strong>. Je tu tedy obrovskÃ¡ pÅ™Ã­leÅ¾itost ğŸ”¥ zÃ­skat data o produktech detekcÃ­ tÄ›chto log!</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Jak by je mÄ›l Open Food Facts detekovat? DÃ­ky kombinaci technologiÃ­ a pÅ™ispÄ›vatelÅ¯, jako vÅ¾dy!</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>RaphaÃ«l Bournhonesque, bÃ½valÃ½ pÅ™ispÄ›vatel Open Food Facts, kterÃ½ je nynÃ­ souÄÃ¡stÃ­ stÃ¡lÃ©ho tÃ½mu a mÅ¯j vedoucÃ­ stÃ¡Å¾e, vyvinul v Robotoff* <strong>systÃ©m pro extrakci log z obrÃ¡zkÅ¯, jejich pÅ™evod do vektorÅ¯ a nalezenÃ­ nejbliÅ¾Å¡Ã­ch sousedÅ¯ kaÅ¾dÃ©ho vektoru.</strong> CÃ­lem nalezenÃ­ sousedÅ¯ log bylo <strong>umoÅ¾nit pÅ™ispÄ›vatelÅ¯m â€anotovatâ€œ (manuÃ¡lnÄ› kategorizovat) obrovskÃ© mnoÅ¾stvÃ­ log souÄasnÄ› prostÅ™ednictvÃ­m platformy s nÃ¡zvem <a rel="noreferrer noopener" href="https://hunger.openfoodfacts.org/" target="_blank">Hunger Games</a> </strong>ğŸ˜‰.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Modely a algoritmy pouÅ¾Ã­vanÃ© v tÃ© dobÄ› vÅ¡ak nemohly poskytnout dostateÄnÄ› efektivnÃ­ vÃ½sledky.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>V zÃ¡Å™Ã­ 2022 jsem se jÃ¡, student inÅ¾enÃ½rstvÃ­, pÅ™ipojil k tÃ½mu na 6mÄ›sÃ­ÄnÃ­ stÃ¡Å¾ vÄ›novanou logÅ¯m a pracoval jsem na refaktoringu celÃ©ho tohoto procesu! ğŸ¥³&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:table -->
<figure class="wp-block-table"><table><tbody><tr><td><strong>* Co je Robotoff?</strong><br><a rel="noreferrer noopener" href="https://github.com/openfoodfacts/robotoff" target="_blank">Robotoff</a> je sluÅ¾ba vyvinutÃ¡ pÅ™ispÄ›vateli na pomoc pÅ™i zpracovÃ¡nÃ­ dat Open Food Facts. Na zÃ¡kladÄ› jiÅ¾ dostupnÃ½ch dat v databÃ¡zi je cÃ­lem zÃ­skat co nejvÃ­ce informacÃ­ o kaÅ¾dÃ©m produktu a pÅ™idat je do databÃ¡ze. V souÄasnÃ© dobÄ› aktualizace provedenÃ© Robotoffem pochÃ¡zejÃ­ z analÃ½zy obrÃ¡zkÅ¯, pÅ™es optickÃ© rozpoznÃ¡vÃ¡nÃ­ znakÅ¯ nebo obecnÄ›jÅ¡Ã­ modely poÄÃ­taÄovÃ©ho vidÄ›nÃ­. NÄ›kterÃ© aktualizace se na db aplikujÃ­ automaticky, ale jinÃ© vyÅ¾adujÃ­ ruÄnÃ­ ovÄ›Å™enÃ­ prostÅ™ednictvÃ­m otÃ¡zek nebo Hunger Games.<br><br><em><strong>Chcete-li se o Robotoff dozvÄ›dÄ›t vÃ­ce, podÃ­vejte se <a rel="noreferrer noopener" href="https://github.com/openfoodfacts/robotoff#readme" target="_blank">sem</a>!</strong></em>ğŸ‘€</td></tr></tbody></table></figure>
<!-- /wp:table -->

<!-- wp:heading {"level":3} -->
<h3><strong>ğŸ«— Drizzle tech: </strong>Jak pÅ™esnÄ› funguje zpracovÃ¡nÃ­ log?</h3>
<!-- /wp:heading -->

<!-- wp:heading {"level":4} -->
<h4><em>1ï¸âƒ£ </em>Extrahujte loga z obrÃ¡zkÅ¯ produktÅ¯:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Open Food Facts pÅ™ispÄ›vatelÃ© vycviÄili model strojovÃ©ho uÄenÃ­, aby rozpoznali loga v obrÃ¡zcÃ­ch. Jako vstup modelu vloÅ¾Ã­me obrÃ¡zek a obdrÅ¾Ã­me nÄ›kolik ohraniÄujÃ­cÃ­ch rÃ¡meÄkÅ¯ s odpovÃ­dajÃ­cÃ­mi skÃ³re a tÅ™Ã­dami. TÅ™Ã­dy, ve kterÃ½ch byl model trÃ©novÃ¡n, byly â€znaÄkaâ€œ a â€Å¡tÃ­tekâ€œ.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>KÃ³d, kde se model nazÃ½vÃ¡, najdete zde: <a href="https://github.com/openfoodfacts/robotoff/blob/b209707cc062310b51f9886c87ee14be91527644/robotoff/workers/tasks/import_image.py#L325" target="_blank" rel="noreferrer noopener">Robotoff.import_image.py</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>MÅ¯Å¾ete to vyzkouÅ¡et pomocÃ­ nÃ¡sledujÃ­cÃ­ho API:&nbsp;<a href="https://robotoff.openfoodfacts.net/api/v1/images/predict?image_url=[image_url]&amp;models=universal-logo-detector" target="_blank" rel="noreferrer noopener">https://robotoff.openfoodfacts.net/api/v1/images/predict?image_url=[image_url]&amp;models=universal-logo-detector</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>S ohraniÄujÃ­cÃ­mi rÃ¡meÄky mÅ¯Å¾ete vidÄ›t, jakÃ¡ jsou odpovÃ­dajÃ­cÃ­ loga s API: <a href="https://robotoff.openfoodfacts.net/api/v1/images/crop?image_url=[image_url]&amp;y_min=[y_min]&amp;x_min=[x_min]&amp;y_max=[y_max]&amp;x_max=[x_max]" target="_blank" rel="noreferrer noopener">https://robotoff.openfoodfacts.net/api/v1/images/crop?image_url=[image_url]&amp;y_min=[y_min]&amp;x_min=[x_min]&amp;y_max=[y_max]&amp;x_max=[x_max]</a> kde souÅ™adnice jsou ve stejnÃ©m poÅ™adÃ­ jako souÅ™adnice vrÃ¡cenÃ© modelem v ohraniÄovacÃ­ch rÃ¡meÄcÃ­ch.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Zde je pÅ™Ã­klad toho, co se stane pÅ™i pouÅ¾itÃ­ tÄ›chto rozhranÃ­ API s nÃ¡sledujÃ­cÃ­m obrÃ¡zkem:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://images.openfoodfacts.org/images/products/322/982/012/9488/front_fr.194.400.jpg" target="_blank" rel="noreferrer noopener">https://images.openfoodfacts.org/images/products/322/982/012/9488/front_fr.194.400.jpg</a></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3425,"width":806,"height":252,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large is-resized"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Screenshot-2023-02-14-at-14.34.51-1024x321.png" alt="" class="wp-image-3425" width="806" height="252"/></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4><em>2ï¸âƒ£ </em>PÅ™evÃ©st obrÃ¡zky loga na Vectory:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>TeÄ, kdyÅ¾ mÃ¡me pÅ™Ã­stup k logÅ¯m, musÃ­me je vektorizovat</strong>. K tomu pouÅ¾Ã­vÃ¡me pÅ™edÅ¡kolenÃ½ model od OpenAI nazvanÃ½ <a href="https://huggingface.co/docs/transformers/model_doc/clip" target="_blank" rel="noreferrer noopener">CLIP</a>. I kdyÅ¾ byl model pÅ¯vodnÄ› trÃ©novÃ¡n tak, aby odpovÃ­dal obrÃ¡zkÅ¯m a textu, pouÅ¾Ã­vÃ¡me pouze ÄÃ¡st modelu â€poÄÃ­taÄovÃ© vidÄ›nÃ­â€œ, abychom zÃ­skali vloÅ¾enÃ­ (=loga vloÅ¾enÃ¡ do vektorovÃ©ho prostoru) vypoÄÃ­tanÃ© pomocÃ­ CLIP pro kaÅ¾dÃ© logo.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>MÃ¡me tedy obrÃ¡zek loga jako vstup a vektor o rozmÄ›ru 512 jako vÃ½stup. ÄŒÃ­m menÅ¡Ã­ je vzdÃ¡lenost mezi dvÄ›ma vektory, tÃ­m podobnÄ›jÅ¡Ã­ jsou dvÄ› odpovÃ­dajÃ­cÃ­ loga.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Funkce <a href="https://github.com/openfoodfacts/robotoff/blob/b209707cc062310b51f9886c87ee14be91527644/robotoff/workers/tasks/import_image.py#L398" target="_blank" rel="noreferrer noopener">save_logo_embeddings</a> v Robotoff mÃ¡ na starosti aplikaci modelu na loga a uklÃ¡dÃ¡nÃ­ vloÅ¾enÃ­ do databÃ¡ze Postgresql Robotoff.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>VÃ­ce explicitnÃ­ho kÃ³du <a href="https://github.com/openfoodfacts/openfoodfacts-ai/blob/develop/logo-ann/generation/02_generate_embeddings.py#L108" target="_blank" rel="noreferrer noopener">naleznete zde</a>, abyste pochopili, jak pouÅ¾Ã­vÃ¡me CLIP pro generovÃ¡nÃ­ vloÅ¾enÃ½ch log.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4><em>3ï¸âƒ£ </em>NajdÄ›te nejbliÅ¾Å¡Ã­ sousedy:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>K nalezenÃ­ nejbliÅ¾Å¡Ã­ch sousedÅ¯ loga pouÅ¾Ã­vÃ¡me â€indexâ€œ k uloÅ¾enÃ­ vloÅ¾enÃ­. Jakmile bude tento index vytvoÅ™en, mohli bychom pouÅ¾Ã­t metodu <strong>â€hrubÃ¡ sÃ­laâ€œ ğŸ’ª, kterÃ¡ spoÄÃ­vÃ¡ ve vÃ½poÄtu vzdÃ¡lenosti mezi logem dotazu a vÅ¡emi ostatnÃ­mi logy db a vrÃ¡tÃ­me ta nejbliÅ¾Å¡Ã­</strong>. To je nejpÅ™esnÄ›jÅ¡Ã­ metoda, protoÅ¾e nÃ¡m poskytuje â€skuteÄnÃ©â€œ nejbliÅ¾Å¡Ã­ sousedy. Tato metoda je vÅ¡ak pÅ™Ã­liÅ¡ pomalÃ¡ na to, aby byla pouÅ¾ita. ÄŒas potÅ™ebnÃ½ k extrakci nejbliÅ¾Å¡Ã­ch sousedÅ¯ pro kaÅ¾dÃ© logo, kdyÅ¾ je celkovÃ½ poÄet log 2,5 milionu, je pÅ™ibliÅ¾nÄ› 3 s ğŸ˜´</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>ProtoÅ¾e jsme potÅ™ebovali kratÅ¡Ã­ dobu vyhledÃ¡vÃ¡nÃ­ a byli jsme v poÅ™Ã¡dku s menÅ¡Ã­ pÅ™esnostÃ­, rozhodli jsme se pouÅ¾Ã­t <strong>pÅ™ibliÅ¾nou metodu</strong>. Ten, kterÃ½ Robotoff pouÅ¾Ã­vÃ¡, se nazÃ½vÃ¡ HNSW (hierarchical navigable small world). MÅ¯Å¾ete se podÃ­vat na <a rel="noreferrer noopener" href="https://www.pinecone.io/learn/vector-indexes/" target="_blank">tento ÄlÃ¡nek</a>, abyste lÃ©pe porozumÄ›li vyhledÃ¡vÃ¡nÃ­ nejbliÅ¾Å¡Ã­ch sousedÅ¯.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>PomocÃ­ indexu HNSW ElasticSearch je nynÃ­ Robotoff schopen vyhledat nejbliÅ¾Å¡Ã­ sousedy kaÅ¾dÃ©ho vloÅ¾enÃ­ mezi vÃ­ce neÅ¾ 2,5 miliony vektorÅ¯ s obrovskou pÅ™esnostÃ­ (vÃ­ce neÅ¾ 90 % ze 100 vrÃ¡cenÃ½ch nejbliÅ¾Å¡Ã­ch sousedÅ¯ patÅ™Ã­ mezi pÅ™esnÃ½ch 100 skuteÄnÃ½ch nejbliÅ¾Å¡Ã­ch sousedÅ¯) a krÃ¡tkÃ¡ doba vyhledÃ¡vÃ¡nÃ­ mÃ©nÄ› neÅ¾ 100 ms ğŸ‘ğŸ‘ğŸ‘ğŸ‘.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>K zÃ­skÃ¡nÃ­ nejbliÅ¾Å¡Ã­ch sousedÅ¯ loga mÅ¯Å¾ete pouÅ¾Ã­t nÃ¡sledujÃ­cÃ­ API: <a href="https://robotoff.openfoodfacts.org/api/v1/ann/search/[logo_id]?count=[count]">https://robotoff.openfoodfacts.org/api/v1/ann/search/[logo_id]?count=[count]</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>ğŸ¯ NÄ›kolik pÅ™Ã­spÄ›vkÅ¯: </strong>Kde se pouÅ¾Ã­vÃ¡?</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>V Robotoff zatÃ­m nenÃ­ implementovÃ¡na Å¾Ã¡dnÃ¡ automatickÃ¡ kategorizace loga. VÅ¡e, co jsem vysvÄ›tlil dÅ™Ã­ve, je vytvoÅ™eno pouze pro <a href="https://hunger.openfoodfacts.org/">Hunger Games</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Co to je? JednÃ¡ se o <strong>anotaÄnÃ­ platformu </strong>vyvinutou pÅ™ispÄ›vatelem jmÃ©nem Alexandre Fauquette, kterÃ¡ <strong>umoÅ¾Åˆuje kaÅ¾dÃ©mu odpovÃ­dat na kontrolnÃ­ pÅ™edpovÄ›di vytvoÅ™enÃ© Robotoffem a kategorizovat loga</strong>.&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><br>MÅ¯Å¾ete to zkusit. UvÃ­tÃ¡ vÃ¡s rychlÃ½ Ãºvod/tutoriÃ¡l a budete moci anotovat loga! ğŸ˜‰<br>Video tutoriÃ¡l â€Jak pouÅ¾Ã­vat Hunger Games?â€œ mÄ›l by vyjÃ­t brzyâ€¦ â³</p>
<!-- /wp:paragraph -->

<!-- wp:image {"align":"center","id":3433,"width":505,"height":633,"sizeSlug":"full","linkDestination":"custom"} -->
<figure class="wp-block-image aligncenter size-full is-resized"><a href="hunger.openfoodfacts.org"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Screenshot-2023-02-14-at-14.44.23.png" alt="" class="wp-image-3433" width="505" height="633"/></a><figcaption class="wp-element-caption">Chcete-li hrÃ¡t Hunger Games: hunger.openfoodfacts.org</figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><strong>Anotace log vylepÅ¡ujÃ­ fakta o otevÅ™enÃ½ch potravinÃ¡ch, protoÅ¾e roste mnoÅ¾stvÃ­ ÃºdajÅ¯, kterÃ© mÃ¡me o produktech a jejich kvalitÄ›.</strong> A dÃ­ky modelÅ¯m a algoritmÅ¯m pouÅ¾Ã­vanÃ½m na pozadÃ­ mÅ¯Å¾ete bÃ½t mnohem vÃ½konnÄ›jÅ¡Ã­ a mÃ­t vÄ›tÅ¡Ã­ vliv na kaÅ¾dodennÃ­ stravovÃ¡nÃ­ lidÃ­ ğŸ¥°.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>ÄŒlÃ¡nek od Gabriela</p>
<!-- /wp:paragraph -->

<!-- wp:image {"align":"left","id":3418,"width":167,"height":167,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image alignleft size-full is-resized"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Gabriel.png" alt="" class="wp-image-3418" width="167" height="167"/></figure>
<!-- /wp:image -->
