Kuinka Open Food Facts k√§ytt√§√§ logoja saadakseen tietoa elintarviketuotteista

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>üßÇRipaus kontekstista:</strong> "logot" ?</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Open Food Facts on t√§ytetty noin <strong>3 miljoonalla tuotteella</strong>. Jokaisella tuotteella on pakkaus, joka on tehty houkuttelemaan mahdollisimman paljon ihmisi√§. T√§ss√§ suhteessa tuottajat korostavat tuotteidensa ominaisuuksia<strong> r√§ikeill√§ ja selkeill√§ symboleilla</strong>. N√§it√§ symboleita on lukuisia ja ne voivat antaa tietoa tuotteen merkist√§, laadusta, koostumuksesta, valmistustavasta, mihin roskikseen se tulee h√§vitt√§√§ jne‚Ä¶&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Kaikkien symbolien homogenisoimiseksi ja kuluttajien auttamiseksi l√∂yt√§m√§√§n heille sopivia tuotteita, <strong>useat laitokset ovat luoneet tiukat s√§√§nn√∂t tuottajille, jotta he voivat merkit√§ tuotteensa erityisill√§ symboleilla, joita kutsumme "logoiksi"</strong>. On siis huikea mahdollisuus üî• saada tietoa tuotteista tunnistamalla n√§m√§ logot!</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Miten Open Food Factsin pit√§isi havaita ne? Kiitos tekniikan ja avustajien sekoituksen, kuten aina!</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Rapha√´l Bournhonesque, entinen Open Food Facts -avustaja, joka on nyt osa pysyv√§√§ tiimi√§ ja ty√∂harjoitteluohjaajani, oli kehitt√§nyt Robotoffissa* <strong>j√§rjestelm√§n logojen poimimiseksi kuvista, niiden muuntamiseksi vektoreiksi ja l√§himpien vektorien naapureiden l√∂yt√§miseksi.</strong> Logojen naapureiden l√∂yt√§misen tavoitteena oli <strong>antaa kirjoittajille mahdollisuus "merkit√§" (luokitella manuaalisesti) valtavia m√§√§ri√§ logoja samanaikaisesti <a rel="noreferrer noopener" href="https://hunger.openfoodfacts.org/" target="_blank">Hunger Games -nimisen alustan kautta.</a> </strong>üòâ.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Tuolloin k√§ytetyt mallit ja algoritmit eiv√§t kuitenkaan antaneet tarpeeksi tehokkaita tuloksia.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Syyskuussa 2022 min√§, insin√∂√∂riopiskelija, liityin tiimiin 6 kuukauden harjoitteluun, joka olisi omistettu logoille, ja ty√∂skentelin koko prosessin refaktoroinnin parissa! ü•≥&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:table -->
<figure class="wp-block-table"><table><tbody><tr><td><strong>* Mik√§ on Robotoff?</strong><br><a rel="noreferrer noopener" href="https://github.com/openfoodfacts/robotoff" target="_blank">Robotoff</a> on avustajien kehitt√§m√§ palvelu, joka auttaa Open Food Facts -tietojen k√§sittelyss√§. Tietokannassa jo olevien tietojen perusteella tavoitteena on hakea jokaisesta tuotteesta mahdollisimman paljon tietoa ja lis√§t√§ ne tietokantaan. T√§ll√§ hetkell√§ Robotoffin tekem√§t p√§ivitykset tulevat kuva-analyysist√§, optisen merkintunnistuksen tai yleisemmist√§ Computer Vision -malleista. Jotkut p√§ivitykset otetaan automaattisesti k√§ytt√∂√∂n tietokannassa, mutta toiset tarvitsevat manuaalisen vahvistuksen kysymysten tai N√§lk√§pelien kautta.<br><br><em><strong>Jos haluat tiet√§√§ lis√§√§ Robotoffista, katso <a rel="noreferrer noopener" href="https://github.com/openfoodfacts/robotoff#readme" target="_blank">t√§st√§</a>!</strong></em>üëÄ</td></tr></tbody></table></figure>
<!-- /wp:table -->

<!-- wp:heading {"level":3} -->
<h3><strong>ü´ó Tihkua tekniikkaa: </strong>Miten logojen k√§sittely toimii tarkalleen?</h3>
<!-- /wp:heading -->

<!-- wp:heading {"level":4} -->
<h4><em>1Ô∏è‚É£ </em>Poimi logot tuotteiden kuvista:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Open Food Facts -avustajat kouluttivat koneoppimismallin tunnistamaan logot kuvissa. Laitamme kuvan mallin sy√∂tteeksi ja saamme useita rajausruutuja vastaavilla pisteill√§ ja luokilla. Luokat, joissa mallia koulutettiin, olivat "br√§ndi" ja "etiketti".</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>L√∂yd√§t mallin kutsun koodin t√§√§lt√§: <a href="https://github.com/openfoodfacts/robotoff/blob/b209707cc062310b51f9886c87ee14be91527644/robotoff/workers/tasks/import_image.py#L325" target="_blank" rel="noreferrer noopener">Robotoff.import_image.py</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Voit kokeilla sit√§ seuraavan API:n avulla:&nbsp;<a href="https://robotoff.openfoodfacts.net/api/v1/images/predict?image_url=[image_url]&amp;models=universal-logo-detector" target="_blank" rel="noreferrer noopener">https://robotoff.openfoodfacts.net/api/v1/images/predict?image_url=[image_url]&amp;models=universal-logo-detector</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Rajoituslaatikoiden avulla n√§et, mitk√§ ovat vastaavat logot API:lla: <a href="https://robotoff.openfoodfacts.net/api/v1/images/crop?image_url=[image_url]&amp;y_min=[y_min]&amp;x_min=[x_min]&amp;y_max=[y_max]&amp;x_max=[x_max]" target="_blank" rel="noreferrer noopener">https://robotoff.openfoodfacts.net/api/v1/images/crop?image_url=[image_url]&amp;y_min=[y_min]&amp;x_min=[x_min]&amp;y_max=[y_max]&amp;x_max=[x_max]</a> jossa koordinaatit ovat samassa j√§rjestyksess√§ kuin mallin palauttamat rajoituslaatikoissa.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>T√§ss√§ on esimerkki siit√§, mit√§ tapahtuu, kun n√§it√§ sovellusliittymi√§ k√§ytet√§√§n seuraavan kuvan kanssa:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://images.openfoodfacts.org/images/products/322/982/012/9488/front_fr.194.400.jpg" target="_blank" rel="noreferrer noopener">https://images.openfoodfacts.org/images/products/322/982/012/9488/front_fr.194.400.jpg</a></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3425,"width":806,"height":252,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large is-resized"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Screenshot-2023-02-14-at-14.34.51-1024x321.png" alt="" class="wp-image-3425" width="806" height="252"/></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4><em>2Ô∏è‚É£ </em>Muunna logokuvat vektoreiksi:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Nyt kun voimme k√§ytt√§√§ logoja, meid√§n on vektorisoitava ne</strong>. T√§t√§ varten k√§yt√§mme OpenAI:n esikoulutettua mallia nimelt√§ <a href="https://huggingface.co/docs/transformers/model_doc/clip" target="_blank" rel="noreferrer noopener">CLIP</a>. Vaikka malli oli alun perin opetettu sovittamaan kuvia tekstiin, k√§yt√§mme vain mallin "tietokonen√§k√∂ist√§" osaa saadaksemme CLIP:n jokaiselle logolle laskemat upotteet (=logot upotettuina vektoritilaan).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Meill√§ on siis logokuva sy√∂tteen√§ ja vektori, jonka mitta on 512, l√§ht√∂n√§. Mit√§ pienempi et√§isyys kahden vektorin v√§lill√§ on, sit√§ samankaltaisempia kaksi vastaavaa logoa ovat.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Robotoffin <a href="https://github.com/openfoodfacts/robotoff/blob/b209707cc062310b51f9886c87ee14be91527644/robotoff/workers/tasks/import_image.py#L398" target="_blank" rel="noreferrer noopener">save_logo_embeddings</a> -toiminto vastaa mallin soveltamisesta logoihin ja upotusten tallentamisesta Robotoffin postgresql-tietokantaan.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>L√∂yd√§t tarkemman koodin <a href="https://github.com/openfoodfacts/openfoodfacts-ai/blob/develop/logo-ann/generation/02_generate_embeddings.py#L108" target="_blank" rel="noreferrer noopener">t√§√§lt√§</a> ymm√§rt√§√§ksesi, kuinka k√§yt√§mme CLIP:i√§ logojen upottamista varten.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4><em>3Ô∏è‚É£ </em>Etsi l√§himm√§t naapurit:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Logon l√§himpien naapurien l√∂yt√§miseksi k√§yt√§mme "hakemistoa" upotusten tallentamiseen. Kun t√§m√§ indeksi on rakennettu, voimme k√§ytt√§√§ <strong>"raaka voima" üí™ -menetelm√§√§, jossa lasketaan kyselylogon ja kaikkien muiden db:n logojen v√§linen et√§isyys ja palautetaan l√§himm√§t</strong>. Se on tarkin menetelm√§, koska se antaa meille "todelliset" l√§himm√§t naapurit. T√§m√§ menetelm√§ on kuitenkin liian hidas k√§ytett√§v√§ksi. Jokaisen logon l√§himpien naapureiden poimimiseen tarvittava aika, kun logoja on yhteens√§ 2,5M, on noin 3s üò¥</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Koska tarvitsimme parempaa hakuaikaa ja halusimme pienemm√§n tarkkuuden, p√§√§timme k√§ytt√§√§ <strong>likim√§√§r√§ist√§ menetelm√§√§</strong>. Sit√§, jota Robotoff k√§ytt√§√§, kutsutaan nimell√§ HNSW (hierarchical navigable small world). Voit katsoa <a rel="noreferrer noopener" href="https://www.pinecone.io/learn/vector-indexes/" target="_blank">t√§t√§ artikkelia</a> ymm√§rt√§√§ksesi paremmin l√§himpien naapureiden haun.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>K√§ytt√§m√§ll√§ HNSW ElasticSearch -indeksi√§ Robotoff pystyy nyt etsim√§√§n kunkin upotuksen l√§himm√§t naapurit yli 2,5 miljoonan vektorin joukosta valtavalla tarkkuudella (yli 90 % palautetusta sadasta l√§himm√§st√§ naapurista on t√§sm√§lleen 100 todellisen l√§hinaapurin joukossa) ja lyhyt hakuaika alle 100 ms üëèüëèüëèüëè.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Voit k√§ytt√§√§ seuraavia sovellusliittymi√§ saadaksesi logon l√§himm√§t naapurit: <a href="https://robotoff.openfoodfacts.org/api/v1/ann/search/[logo_id]?count=[count]">https://robotoff.openfoodfacts.org/api/v1/ann/search/[logo_id]?count=[count]</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>üçØ Lusikka lahjoituksia: </strong>Miss√§ sit√§ k√§ytet√§√§n?</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Robotoffissa ei ole viel√§ otettu k√§ytt√∂√∂n automaattista logojen luokittelua. Kaikki mit√§ selitin aiemmin, on tehty vain <a href="https://hunger.openfoodfacts.org/">N√§lk√§peli√§</a> varten.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What is it ? Se on <strong>merkint√§alusta </strong>, jonka on kehitt√§nyt avustaja nimelt√§ Alexandre Fauquette ja jonka <strong>avulla kaikki voivat vastata Robotoffin tekemiin tarkistusennusteisiin ja luokitella logot</strong>.&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><br>Voit kokeilla sit√§. Nopea esittely/opastus toivottaa sinut tervetulleeksi ja voit merkit√§ logoja! üòâ<br>Video-opastus aiheesta "Kuinka k√§ytt√§√§ N√§lk√§peli√§?" pit√§isi ilmesty√§ pian‚Ä¶ ‚è≥</p>
<!-- /wp:paragraph -->

<!-- wp:image {"align":"center","id":3433,"width":505,"height":633,"sizeSlug":"full","linkDestination":"custom"} -->
<figure class="wp-block-image aligncenter size-full is-resized"><a href="hunger.openfoodfacts.org"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Screenshot-2023-02-14-at-14.44.23.png" alt="" class="wp-image-3433" width="505" height="633"/></a><figcaption class="wp-element-caption">N√§lk√§pelin pelaaminen: hunger.openfoodfacts.org</figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><strong>Merkint√§logot parantavat Open Food Facts -palvelua, kun se lis√§√§ tuotteistamme ja niiden laadusta saatavan tiedon m√§√§r√§√§.</strong> Ja taustalla k√§ytettyjen mallien ja algoritmien ansiosta voit olla paljon tehokkaampi ja vaikuttaa ihmisten p√§ivitt√§iseen ravintoon ü•∞.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Artikkelin kirjoittanut Gabriel</p>
<!-- /wp:paragraph -->

<!-- wp:image {"align":"left","id":3418,"width":167,"height":167,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image alignleft size-full is-resized"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Gabriel.png" alt="" class="wp-image-3418" width="167" height="167"/></figure>
<!-- /wp:image -->
