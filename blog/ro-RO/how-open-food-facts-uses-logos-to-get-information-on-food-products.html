Cum Open Food Facts foloseÈ™te logo-urile pentru a obÈ›ine informaÈ›ii despre produsele alimentare

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>ğŸ§‚Un pic de context:</strong> â€sigleâ€?</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Open Food Facts este plin cu aproximativ <strong>milioane de produse</strong>. Fiecare produs are un ambalaj care este fÄƒcut pentru a atrage cÃ¢t mai mulÈ›i oameni. Ãn acest sens, producÄƒtorii evidenÈ›iazÄƒ calitÄƒÈ›ile produselor lor cu<strong> simboluri strÄƒlucitoare È™i explicite</strong>. Aceste simboluri sunt numeroase È™i pot oferi informaÈ›ii despre marca produsului, calitatea acestuia, compoziÈ›ia sa, modul Ã®n care a fost fÄƒcut, Ã®n ce boabe sÄƒ-l aruncaÈ›i etc.â€¦&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Pentru a omogeniza toate simbolurile È™i a ajuta consumatorii sÄƒ gÄƒseascÄƒ produse care li se potrivesc, <strong>diferite instituÈ›ii au creat reguli stricte pentru ca producÄƒtorii sÄƒ Ã®È™i poatÄƒ marca produsele cu simboluri specifice pe care le numim â€logo-uriâ€</strong>. ExistÄƒ astfel o oportunitate uriaÈ™Äƒ ğŸ”¥ de a obÈ›ine date despre produse prin detectarea acestor sigle!</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Cum ar trebui sÄƒ le detecteze Open Food Facts? DatoritÄƒ amestecului dintre tehnologie È™i colaboratori, ca Ã®ntotdeauna!</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>RaphaÃ«l Bournhonesque, un fost colaborator Open Food Facts, care acum face parte din echipa permanentÄƒ È™i supervizorul meu de stagiu, a dezvoltat Ã®n Robotoff* <strong>un sistem pentru a extrage sigle din imagini, a le converti Ã®n vectori È™i a gÄƒsi cei mai apropiaÈ›i vecini ai fiecÄƒrui vector.</strong> Scopul gÄƒsirii vecinilor siglelor a fost <strong>acela de a permite colaboratorilor sÄƒ â€adnotezeâ€ (sÄƒ clasifice manual) cantitÄƒÈ›i masive de sigle Ã®n acelaÈ™i timp printr-o platformÄƒ, numitÄƒ <a rel="noreferrer noopener" href="https://hunger.openfoodfacts.org/" target="_blank">Hunger Games</a> </strong>ğŸ˜‰.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Cu toate acestea, modelele È™i algoritmii utilizaÈ›i atunci nu puteau da rezultate suficient de eficiente.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Ãn septembrie 2022, eu, student la inginerie, m-am alÄƒturat echipei pentru un stagiu de 6 luni care avea sÄƒ fie dedicat logo-urilor È™i am lucrat la refactorizarea Ã®ntregului proces! ğŸ¥³&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:table -->
<figure class="wp-block-table"><table><tbody><tr><td><strong>* Ce este Robotoff?</strong><br><a rel="noreferrer noopener" href="https://github.com/openfoodfacts/robotoff" target="_blank">Robotoff</a> este un serviciu dezvoltat de colaboratori pentru a ajuta la procesarea datelor Open Food Facts. Pe baza datelor deja disponibile Ã®n baza de date, scopul este de a prelua cÃ¢t mai multe informaÈ›ii despre fiecare produs È™i de a le adÄƒuga Ã®n db. Ãn prezent, actualizÄƒrile realizate de Robotoff provin din analiza imaginilor, prin recunoaÈ™terea opticÄƒ a caracterelor sau modele mai generale de Computer Vision. Unele actualizÄƒri sunt aplicate automat la db, dar altele necesitÄƒ validare manualÄƒ prin Ã®ntrebÄƒri sau Hunger Games.<br><br><em><strong>Pentru a afla mai multe despre Robotoff, aruncaÈ›i o privire <a rel="noreferrer noopener" href="https://github.com/openfoodfacts/robotoff#readme" target="_blank">aici</a>!</strong></em>ğŸ‘€</td></tr></tbody></table></figure>
<!-- /wp:table -->

<!-- wp:heading {"level":3} -->
<h3><strong>ğŸ«— Un strop de tehnologie: </strong>Cum funcÈ›ioneazÄƒ exact procesarea logo-urilor?</h3>
<!-- /wp:heading -->

<!-- wp:heading {"level":4} -->
<h4><em>1ï¸âƒ£ </em>Extrage siglele din imaginile produselor:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Colaboratorii Open Food Facts au instruit un model de Ã®nvÄƒÈ›are automatÄƒ pentru a recunoaÈ™te siglele Ã®n imagini. Punem o imagine ca intrare a modelului È™i primim mai multe casete de delimitare cu scorurile È™i clasele corespunzÄƒtoare. Clasele pe care a fost instruit modelul au fost â€brandâ€ È™i â€labelâ€.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>PuteÈ›i gÄƒsi codul unde este numit modelul aici: <a href="https://github.com/openfoodfacts/robotoff/blob/b209707cc062310b51f9886c87ee14be91527644/robotoff/workers/tasks/import_image.py#L325" target="_blank" rel="noreferrer noopener">Robotoff.import_image.py</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>PuteÈ›i Ã®ncerca folosind urmÄƒtorul API:&nbsp;<a href="https://robotoff.openfoodfacts.net/api/v1/images/predict?image_url=[image_url]&amp;models=universal-logo-detector" target="_blank" rel="noreferrer noopener">https://robotoff.openfoodfacts.net/api/v1/images/predict?image_url=[image_url]&amp;models=universal-logo-detector</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Cu casetele de delimitare, puteÈ›i vedea care sunt siglele corespunzÄƒtoare cu API: <a href="https://robotoff.openfoodfacts.net/api/v1/images/crop?image_url=[image_url]&amp;y_min=[y_min]&amp;x_min=[x_min]&amp;y_max=[y_max]&amp;x_max=[x_max]" target="_blank" rel="noreferrer noopener">https://robotoff.openfoodfacts.net/api/v1/images/crop?image_url=[image_url]&amp;y_min=[y_min]&amp;x_min=[x_min]&amp;y_max=[y_max]&amp;x_max=[x_max]</a> unde coordonatele sunt Ã®n aceeaÈ™i ordine cu cele returnate de model Ã®n casetele de delimitare.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>IatÄƒ un exemplu de ceea ce se Ã®ntÃ¢mplÄƒ atunci cÃ¢nd utilizaÈ›i aceste API-uri cu urmÄƒtoarea imagine:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://images.openfoodfacts.org/images/products/322/982/012/9488/front_fr.194.400.jpg" target="_blank" rel="noreferrer noopener">https://images.openfoodfacts.org/images/products/322/982/012/9488/front_fr.194.400.jpg</a></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3425,"width":806,"height":252,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large is-resized"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Screenshot-2023-02-14-at-14.34.51-1024x321.png" alt="" class="wp-image-3425" width="806" height="252"/></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4><em>2ï¸âƒ£ </em>ConvertiÈ›i imaginile logo-urilor Ã®n Vectori:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Acum cÄƒ putem accesa logo-uri, trebuie sÄƒ le vectorizam</strong>. Pentru asta, folosim un model pre-antrenat de la OpenAI numit <a href="https://huggingface.co/docs/transformers/model_doc/clip" target="_blank" rel="noreferrer noopener">CLIP</a>. Chiar dacÄƒ modelul a fost antrenat iniÈ›ial pentru a potrivi imaginile cu text, folosim doar partea â€vizualÄƒ pe computerâ€ a modelului pentru a obÈ›ine Ã®nglobÄƒrile (=logo-uri Ã®ncorporate Ã®ntr-un spaÈ›iu vectorial) calculate de CLIP pentru fiecare logo.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Avem astfel o imagine de logo ca intrare È™i un vector cu dimensiunea 512 ca ieÈ™ire. Cu cÃ¢t distanÈ›a dintre doi vectori este mai micÄƒ, cu atÃ¢t cele douÄƒ sigle corespunzÄƒtoare sunt mai asemÄƒnÄƒtoare.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>FuncÈ›ia <a href="https://github.com/openfoodfacts/robotoff/blob/b209707cc062310b51f9886c87ee14be91527644/robotoff/workers/tasks/import_image.py#L398" target="_blank" rel="noreferrer noopener">save_logo_embeddings</a> din Robotoff este responsabilÄƒ de aplicarea modelului logo-urilor È™i de salvarea Ã®nglobÄƒrilor Ã®n baza de date Robotoff postgresql.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>PuteÈ›i gÄƒsi un cod mai explicit <a href="https://github.com/openfoodfacts/openfoodfacts-ai/blob/develop/logo-ann/generation/02_generate_embeddings.py#L108" target="_blank" rel="noreferrer noopener">aici</a> pentru a Ã®nÈ›elege cum folosim CLIP pentru a genera Ã®ncorporarea siglelor.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4><em>3ï¸âƒ£ </em>GÄƒsiÈ›i cei mai apropiaÈ›i vecini:</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Pentru a gÄƒsi cei mai apropiaÈ›i vecini ai unui logo, folosim un â€indexâ€ pentru a stoca Ã®nglobÄƒrile. OdatÄƒ construit acest index, am putea folosi metoda <strong>â€forÈ›Äƒ brutÄƒâ€ ğŸ’ª care constÄƒ Ã®n calcularea distanÈ›ei dintre logo-ul de interogare È™i toate celelalte sigle ale db È™i returnarea celor mai apropiate</strong>. Aceasta este metoda cea mai precisÄƒ, deoarece ne oferÄƒ â€adevÄƒraÈ›iiâ€ cei mai apropiaÈ›i vecini. Cu toate acestea, aceastÄƒ metodÄƒ este prea lentÄƒ pentru a fi aplicatÄƒ. Timpul necesar pentru extragerea celor mai apropiaÈ›i vecini pentru fiecare logo atunci cÃ¢nd numÄƒrul total de sigle este de 2,5 milioane este de aproximativ 3s ğŸ˜´</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Deoarece aveam nevoie de un timp de cÄƒutare mai bun È™i eram de acord sÄƒ avem mai puÈ›inÄƒ precizie, am decis sÄƒ folosim <strong>o metodÄƒ aproximativÄƒ</strong>. Cea pe care o foloseÈ™te Robotoff se numeÈ™te HNSW (hierarhical navigable small world). PuteÈ›i arunca o privire la <a rel="noreferrer noopener" href="https://www.pinecone.io/learn/vector-indexes/" target="_blank">acest articol</a> pentru a Ã®nÈ›elege mai bine cÄƒutarea vecinilor cei mai apropiaÈ›i.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Folosind un index HNSW ElasticSearch, Robotoff este acum capabil sÄƒ caute cei mai apropiaÈ›i vecini ai fiecÄƒrei Ã®ncorporare printre mai mult de 2,5 milioane de vectori cu o precizie uriaÈ™Äƒ (mai mult de 90% din cei mai apropiaÈ›i 100 de vecini returnaÈ›i sunt printre cei mai apropiaÈ›i 100 de vecini adevÄƒraÈ›i) È™i un timp scurt de cÄƒutare mai mic de 100 ms ğŸ‘ğŸ‘ğŸ‘ğŸ‘.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>PuteÈ›i utiliza urmÄƒtorul API pentru a obÈ›ine cei mai apropiaÈ›i vecini ai unui logo: <a href="https://robotoff.openfoodfacts.org/api/v1/ann/search/[logo_id]?count=[count]">https://robotoff.openfoodfacts.org/api/v1/ann/search/[logo_id]?count=[count]</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3><strong>ğŸ¯ O lingurÄƒ de contribuÈ›ii: </strong>Unde se foloseÈ™te?</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Nicio clasificare automatÄƒ a logo-ului nu este Ã®ncÄƒ implementatÄƒ Ã®n Robotoff. Tot ce am explicat mai Ã®nainte este fÄƒcut doar pentru <a href="https://hunger.openfoodfacts.org/">Hunger Games</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Ce este ? Este <strong>o platformÄƒ de adnotare </strong>dezvoltatÄƒ de un colaborator pe nume Alexandre Fauquette care <strong>permite tuturor sÄƒ rÄƒspundÄƒ la previziunile de verificare fÄƒcute de Robotoff È™i sÄƒ clasifice logo-urile</strong>.&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><br>PoÈ›i sÄƒ Ã®ncerci. O introducere/tutorial rapidÄƒ vÄƒ va Ã®ntÃ¢mpina È™i veÈ›i putea adnota sigle! ğŸ˜‰<br>Un tutorial video cu â€Cum sÄƒ foloseÈ™ti Jocurile Foamei?â€ ar trebui sÄƒ iasÄƒ Ã®n curÃ¢ndâ€¦ â³</p>
<!-- /wp:paragraph -->

<!-- wp:image {"align":"center","id":3433,"width":505,"height":633,"sizeSlug":"full","linkDestination":"custom"} -->
<figure class="wp-block-image aligncenter size-full is-resized"><a href="hunger.openfoodfacts.org"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Screenshot-2023-02-14-at-14.44.23.png" alt="" class="wp-image-3433" width="505" height="633"/></a><figcaption class="wp-element-caption">Pentru a juca Jocurile Foamei: hunger.openfoodfacts.org</figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><strong>Adnotarea siglelor Ã®mbunÄƒtÄƒÈ›eÈ™te Open Food Facts pe mÄƒsurÄƒ ce creÈ™te cantitatea de date pe care o avem despre produse È™i calitatea acestora.</strong> È˜i datoritÄƒ modelelor È™i algoritmilor folosiÈ›i Ã®n fundal, puteÈ›i fi mult mai puternic È™i puteÈ›i avea un impact mai mare asupra alimentaÈ›iei zilnice a oamenilor ğŸ¥°.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Articol de Gabriel</p>
<!-- /wp:paragraph -->

<!-- wp:image {"align":"left","id":3418,"width":167,"height":167,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image alignleft size-full is-resized"><img src="https://blog.openfoodfacts.org/wp-content/uploads/2023/02/Gabriel.png" alt="" class="wp-image-3418" width="167" height="167"/></figure>
<!-- /wp:image -->
